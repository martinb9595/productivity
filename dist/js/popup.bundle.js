(()=>{"use strict";function e(e){var t=Math.floor(e/60),n=e%60;return"".concat(t,":").concat(n.toString().padStart(2,"0"))}document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("focusStatus"),n=document.getElementById("openSettings");function o(){chrome.storage.local.get(["isInFocusMode","focusEndTime"],(function(n){if(n.isInFocusMode&&n.focusEndTime){var o=Math.max(0,Math.floor((n.focusEndTime-Date.now())/1e3));o>0?(t.textContent="Focus mode is running... Time left: ".concat(e(o)),t.classList.remove("text-red-500"),t.classList.add("text-green-500")):(t.textContent="Focus mode ended.",t.classList.remove("text-green-500"),t.classList.add("text-red-500"))}else t.textContent="Focus mode is not running.",t.classList.remove("text-green-500"),t.classList.add("text-red-500")}))}var s=document.getElementById("focusStatus");function c(){chrome.runtime.sendMessage({action:"getTimerStatus"},(function(e){if(e&&void 0!==e.timeRemaining){var t=Math.floor(e.timeRemaining/60),n=e.timeRemaining%60;s.textContent="Focus mode is running... Time left: ".concat(t,":").concat(n.toString().padStart(2,"0")),s.classList.remove("text-red-500"),s.classList.add("text-green-500")}else s.textContent="Focus mode is not running.",s.classList.remove("text-green-500"),s.classList.add("text-red-500")}))}chrome.runtime.onMessage.addListener((function(e,t,n){if("updateTimer"===e.action){var o=Math.floor(e.timeRemaining/60),c=e.timeRemaining%60;s.textContent="Focus mode is running... Time left: ".concat(o,":").concat(c.toString().padStart(2,"0")),s.classList.remove("text-red-500"),s.classList.add("text-green-500")}})),setInterval(c,1e3),c(),n&&n.addEventListener("click",(function(){chrome.tabs.create({url:chrome.runtime.getURL("src/html/settings.html")})}));var a=document.getElementById("toggleFocus");a&&a.addEventListener("click",(function(){var t=document.getElementById("focusDuration"),n=document.getElementById("focusStatus"),s=parseInt(t.value,10);isNaN(s)||s<=0?n.textContent="Please enter a valid focus duration.":chrome.runtime.sendMessage({action:"startFocusMode",duration:s},(function(t){if(chrome.storage.local.set({isInFocusMode:!0,focusEndTime:Date.now()+60*s*1e3}),t&&t.success){console.log("Focus mode started"),chrome.storage.local.set({isInFocusMode:!0,focusEndTime:Date.now()+60*s*1e3},(function(){o()}));var c=60*s,a=setInterval((function(){--c>0?(n.textContent="Focus mode is running... Time left: ".concat(e(c)),n.classList.remove("text-red-500"),n.classList.add("text-green-500")):(n.textContent="Focus mode ended.",n.classList.remove("text-green-500"),n.classList.add("text-red-500")),c<=0&&(clearInterval(a),n.textContent="Focus mode ended.",chrome.storage.local.set({isInFocusMode:!1}))}),1e3);n.classList.remove("text-red-500"),n.classList.add("text-green-500")}else console.error("Failed to start focus mode"),n.textContent="Failed to start focus mode."}))}))}))})();