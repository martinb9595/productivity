(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("focusStatus"),t=document.getElementById("openSettings");function o(){chrome.storage.local.get(["isInFocusMode","focusEndTime"],(function(t){if(t.isInFocusMode&&t.focusEndTime){var o=Math.max(0,Math.floor((t.focusEndTime-Date.now())/1e3)),n=Math.floor(o/60),s=o%60;e.textContent="Focus mode is running... Time left: ".concat(n,":").concat(s.toString().padStart(2,"0")),e.classList.remove("text-red-500"),e.classList.add("text-green-500")}else e.textContent=""}))}(function(e,t){function o(){chrome.runtime.sendMessage({action:"getTimerStatus"},(function(e){e&&void 0!==e.timeRemaining&&function(e,t){if(t)if(e>0){var o=Math.floor(e/60),n=e%60;t.textContent="Time remaining in focus mode: ".concat(o,":").concat(n.toString().padStart(2,"0"))}else t.textContent="Focus mode ended"}(e.timeRemaining,t)}))}o(),setInterval(o,e)})(1e3,document.getElementById("focusStatus")),t&&t.addEventListener("click",(function(){chrome.tabs.create({url:chrome.runtime.getURL("src/html/settings.html")})}));var n=document.getElementById("toggleFocus");n&&n.addEventListener("click",(function(){var e=document.getElementById("focusDuration"),t=document.getElementById("focusStatus"),n=parseInt(e.value,10);isNaN(n)||n<=0?t.textContent="Please enter a valid focus duration.":chrome.runtime.sendMessage({action:"startFocusMode",duration:n},(function(e){if(chrome.storage.local.set({isInFocusMode:!0,focusEndTime:Date.now()+60*n*1e3}),e&&e.success){console.log("Focus mode started"),chrome.storage.local.set({isInFocusMode:!0,focusEndTime:Date.now()+60*n*1e3},(function(){o()}));var s=60*n,c=setInterval((function(){s--;var e=Math.floor(s/60),o=s%60;t.textContent="Focus mode is running... Time left: ".concat(e,":").concat(o.toString().padStart(2,"0")),s<=0&&(clearInterval(c),t.textContent="Focus mode ended.",chrome.storage.local.set({isInFocusMode:!1}))}),1e3);t.classList.remove("text-red-500"),t.classList.add("text-green-500")}else console.error("Failed to start focus mode"),t.textContent="Failed to start focus mode."}))}))}))})();